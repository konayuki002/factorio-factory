from sympy import Integer, Rational

from core.enums.assembling_machine import AssemblingMachine
from core.enums.operation_category import OperationCategory

TYPES: dict[AssemblingMachine, str] = {
    AssemblingMachine.StoneFurnace: "furnace",
    AssemblingMachine.OffshorePump: "offshore-pump",
    AssemblingMachine.AssemblingMachine1: "assembling-machine",
    AssemblingMachine.AssemblingMachine2: "assembling-machine",
    AssemblingMachine.Lab: "lab",
    AssemblingMachine.ElectricFurnace: "furnace",
    AssemblingMachine.SteelFurnace: "furnace",
    AssemblingMachine.AssemblingMachine3: "assembling-machine",
    AssemblingMachine.RocketSilo: "rocket-silo",
    AssemblingMachine.OilRefinery: "assembling-machine",
    AssemblingMachine.ChemicalPlant: "assembling-machine",
    AssemblingMachine.Centrifuge: "assembling-machine",
    AssemblingMachine.ElectricMiningDrill: "mining-drill",
    AssemblingMachine.BurnerMiningDrill: "mining-drill",
    AssemblingMachine.Pumpjack: "mining-drill",
}

SPEED: dict[AssemblingMachine, Rational] = {
    AssemblingMachine.StoneFurnace: Integer(1),
    AssemblingMachine.OffshorePump: Integer(0),
    AssemblingMachine.AssemblingMachine1: Rational(1, 2),
    AssemblingMachine.AssemblingMachine2: Rational(3, 4),
    AssemblingMachine.Lab: Integer(0),
    AssemblingMachine.ElectricFurnace: Integer(2),
    AssemblingMachine.SteelFurnace: Integer(2),
    AssemblingMachine.AssemblingMachine3: Rational(5, 4),
    AssemblingMachine.RocketSilo: Integer(1),
    AssemblingMachine.OilRefinery: Integer(1),
    AssemblingMachine.ChemicalPlant: Integer(1),
    AssemblingMachine.Centrifuge: Integer(1),
    AssemblingMachine.ElectricMiningDrill: Rational(1, 2),
    AssemblingMachine.BurnerMiningDrill: Rational(1, 4),
    AssemblingMachine.Pumpjack: Integer(1),
}

CATEGORIES: dict[AssemblingMachine, set[OperationCategory]] = {
    AssemblingMachine.StoneFurnace: {OperationCategory.Smelting},
    AssemblingMachine.OffshorePump: set(),
    AssemblingMachine.AssemblingMachine1: {
        OperationCategory.AdvancedCrafting,
        OperationCategory.BasicCrafting,
        OperationCategory.Crafting,
    },
    AssemblingMachine.AssemblingMachine2: {
        OperationCategory.AdvancedCrafting,
        OperationCategory.BasicCrafting,
        OperationCategory.Crafting,
        OperationCategory.CraftingWithFluid,
    },
    AssemblingMachine.Lab: set(),
    AssemblingMachine.ElectricFurnace: {OperationCategory.Smelting},
    AssemblingMachine.SteelFurnace: {OperationCategory.Smelting},
    AssemblingMachine.AssemblingMachine3: {
        OperationCategory.AdvancedCrafting,
        OperationCategory.BasicCrafting,
        OperationCategory.Crafting,
        OperationCategory.CraftingWithFluid,
    },
    AssemblingMachine.RocketSilo: {OperationCategory.RocketBuilding},
    AssemblingMachine.OilRefinery: {OperationCategory.OilProcessing},
    AssemblingMachine.ChemicalPlant: {OperationCategory.Chemistry},
    AssemblingMachine.Centrifuge: {OperationCategory.Centrifuging},
    AssemblingMachine.ElectricMiningDrill: {OperationCategory.Mining},
    AssemblingMachine.BurnerMiningDrill: {OperationCategory.Mining},
    AssemblingMachine.Pumpjack: {OperationCategory.Mining},
}

ENERGY_USAGE_KW: dict[AssemblingMachine, Rational] = {
    AssemblingMachine.StoneFurnace: Integer(90),
    AssemblingMachine.OffshorePump: Integer(60),
    AssemblingMachine.AssemblingMachine1: Integer(75),
    AssemblingMachine.AssemblingMachine2: Integer(150),
    AssemblingMachine.Lab: Integer(60),
    AssemblingMachine.ElectricFurnace: Integer(180),
    AssemblingMachine.SteelFurnace: Integer(90),
    AssemblingMachine.AssemblingMachine3: Integer(375),
    AssemblingMachine.RocketSilo: Integer(250),
    AssemblingMachine.OilRefinery: Integer(420),
    AssemblingMachine.ChemicalPlant: Integer(210),
    AssemblingMachine.Centrifuge: Integer(350),
    AssemblingMachine.ElectricMiningDrill: Integer(90),
    AssemblingMachine.BurnerMiningDrill: Integer(150),
    AssemblingMachine.Pumpjack: Integer(90),
}

ALLOWED_EFFECTS: dict[AssemblingMachine, set[str]] = {
    AssemblingMachine.StoneFurnace: {"consumption", "pollution", "speed"},
    AssemblingMachine.OffshorePump: set(),
    AssemblingMachine.AssemblingMachine1: {"consumption", "pollution", "speed"},
    AssemblingMachine.AssemblingMachine2: {
        "consumption",
        "pollution",
        "productivity",
        "quality",
        "speed",
    },
    AssemblingMachine.Lab: set(),
    AssemblingMachine.ElectricFurnace: {
        "consumption",
        "pollution",
        "productivity",
        "quality",
        "speed",
    },
    AssemblingMachine.SteelFurnace: {"consumption", "pollution", "speed"},
    AssemblingMachine.AssemblingMachine3: {
        "consumption",
        "pollution",
        "productivity",
        "quality",
        "speed",
    },
    AssemblingMachine.RocketSilo: {"consumption", "pollution", "productivity", "speed"},
    AssemblingMachine.OilRefinery: {
        "consumption",
        "pollution",
        "productivity",
        "speed",
    },
    AssemblingMachine.ChemicalPlant: {
        "consumption",
        "pollution",
        "productivity",
        "quality",
        "speed",
    },
    AssemblingMachine.Centrifuge: {
        "consumption",
        "pollution",
        "productivity",
        "quality",
        "speed",
    },
    AssemblingMachine.ElectricMiningDrill: {
        "consumption",
        "pollution",
        "productivity",
        "quality",
        "speed",
    },
    AssemblingMachine.BurnerMiningDrill: set(),
    AssemblingMachine.Pumpjack: {"consumption", "pollution", "productivity", "speed"},
}

MODULE_SLOTS: dict[AssemblingMachine, int] = {
    AssemblingMachine.StoneFurnace: 0,
    AssemblingMachine.OffshorePump: 0,
    AssemblingMachine.AssemblingMachine1: 0,
    AssemblingMachine.AssemblingMachine2: 2,
    AssemblingMachine.Lab: 2,
    AssemblingMachine.ElectricFurnace: 2,
    AssemblingMachine.SteelFurnace: 0,
    AssemblingMachine.AssemblingMachine3: 4,
    AssemblingMachine.RocketSilo: 4,
    AssemblingMachine.OilRefinery: 3,
    AssemblingMachine.ChemicalPlant: 3,
    AssemblingMachine.Centrifuge: 2,
    AssemblingMachine.ElectricMiningDrill: 3,
    AssemblingMachine.BurnerMiningDrill: 0,
    AssemblingMachine.Pumpjack: 2,
}
